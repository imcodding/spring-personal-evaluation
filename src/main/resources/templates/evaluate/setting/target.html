<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link th:href="@{/css/custom.css}" href="./css/custom.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-latest.min.js"></script>
    <script src="/js/api.js"></script>
</head>

<body>
    <div style="float: right; margin-bottom: 10px">
        <button class="btn-basic btn-color-black">저장</button>
        <button class="btn-basic btn-color-grey">취소</button>
    </div>
    <div class="width-half fLeft" style="margin-top: 40px;">
        <table>
            <tr class="title">
                <td colspan="3">평가자</td>
            </tr>
            <tr class="title">
                <td>소속</td>
                <td>이름</td>
                <td>직위</td>
            </tr>
            <tr class="content row-hover" th:each="user : ${userList}" th:id="${user.no}" onclick="selected(this)">
                <td th:text="${user.dept}"></td>
                <td th:text="${user.name}"></td>
                <td th:text="${user.position}"></td>
            </tr>
        </table>
    </div>
    <div class="width-half fRight">
        <table>
            <tr class="title">
                <td colspan="4">평가대상</td>
            </tr>
            <tr class="title">
                <td>소속</td>
                <td>이름</td>
                <td>직위</td>
                <td>평가여부</td>
            </tr>
            <tr class="content" th:each="target : ${targetList}">
                <td>1</td>
                <td>2</td>
                <td>3</td>
                <td>
                    <input name="isEvaluate" th:id="${target.userId}" type="checkbox">
                </td>
            </tr>
        </table>
    </div>
</body>
</html>
<script>
    let userNo;
    function selected(obj) {
        userNo = obj.id;

        let list = [];
        let params = {};

        let query = $('input[name="isEvaluate"]:checked');
        $.each(query, function (idx, item) {
            list.push({ targetId: item.id })
        })
        params.no = userNo;

        API.post('/evaluate/setting/target', {
            data: params,
            success: function (result) {
                console.log('result', result)
            }
        })

        API.get('/evaluate/targets', {
            data: {},
            success: function (result) {
                console.log('get', result)
            }
        })
    }
</script>